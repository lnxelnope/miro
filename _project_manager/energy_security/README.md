# MIRO Energy Security Upgrade

> **üì¶ Documentation Package ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Junior Developer**  
> **‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ñ‡∏≤‡∏° - ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏£‡∏ö 100%**

---

## üöÄ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà

### ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Junior Developer:

**‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 1:** ‡∏≠‡πà‡∏≤‡∏ô‡πÑ‡∏ü‡∏•‡πå‡∏ô‡∏µ‡πâ‡∏Å‡πà‡∏≠‡∏ô üëá

```
üìñ 00_QUICK_START.md
```

‡πÑ‡∏ü‡∏•‡πå‡∏ô‡∏µ‡πâ‡∏°‡∏µ:
- ‚úÖ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Setup ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏ó‡∏µ‡πà Senior ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÅ‡∏•‡πâ‡∏ß
- ‚úÖ Checklist ‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≥
- ‚úÖ Commands ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏ö‡πà‡∏≠‡∏¢
- ‚úÖ ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ñ‡∏≤‡∏°‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ï‡∏¥‡∏î‡∏õ‡∏±‡∏ç‡∏´‡∏≤

**‡πÄ‡∏ß‡∏•‡∏≤:** 10 ‡∏ô‡∏≤‡∏ó‡∏µ

---

## üìö ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£

```
energy_security/
‚îÇ
‚îú‚îÄ‚îÄ README.md                    ‚Üê ‡∏Ñ‡∏∏‡∏ì‡∏≠‡∏¢‡∏π‡πà‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà
‚îÇ
‚îú‚îÄ‚îÄ 00_QUICK_START.md           ‚Üê üöÄ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà! (‡∏≠‡πà‡∏≤‡∏ô‡∏Å‡πà‡∏≠‡∏ô)
‚îú‚îÄ‚îÄ 00_OVERVIEW.md              ‚Üê ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏° Project
‚îÇ
‚îú‚îÄ‚îÄ 01_PHASE1_FIRESTORE.md      ‚Üê üî¥ Day 1-2 (CRITICAL)
‚îú‚îÄ‚îÄ 02_PHASE2_PURCHASE.md       ‚Üê üî¥ Day 3-4 (CRITICAL)
‚îú‚îÄ‚îÄ 03_PHASE3_ENCRYPTION.md     ‚Üê üü° Day 5 (HIGH)
‚îú‚îÄ‚îÄ 04_PHASE4_APPCHECK.md       ‚Üê üü¢ Day 6 (OPTIONAL)
‚îÇ
‚îî‚îÄ‚îÄ 99_TESTING_CHECKLIST.md     ‚Üê ‚úÖ ‡πÉ‡∏ä‡πâ test ‡∏ó‡∏∏‡∏Å Phase
```

---

## üéØ ‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢ Project

**‡πÅ‡∏Å‡πâ‡∏ä‡πà‡∏≠‡∏á‡πÇ‡∏´‡∏ß‡πà‡∏î‡πâ‡∏≤‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡∏Ç‡∏≠‡∏á‡∏£‡∏∞‡∏ö‡∏ö Energy ‡πÉ‡∏ô MIRO App**

### ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏´‡∏•‡∏±‡∏Å 4 ‡∏Ç‡πâ‡∏≠:

| # | ‡∏õ‡∏±‡∏ç‡∏´‡∏≤ | ‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö | Phase ‡∏ó‡∏µ‡πà‡πÅ‡∏Å‡πâ |
|---|-------|---------|-------------|
| 1 | Balance ‡πÄ‡∏Å‡πá‡∏ö‡πÉ‡∏ô SharedPreferences ‡πÑ‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏´‡∏±‡∏™ | User ‡πÅ‡∏Å‡πâ‡πÑ‡∏î‡πâ ‚Üí Energy ‡∏ü‡∏£‡∏µ | Phase 1 |
| 2 | Backend ‡πÄ‡∏ä‡∏∑‡πà‡∏≠ Balance ‡∏à‡∏≤‡∏Å Client | Token forgery ‚Üí Energy ‡∏ü‡∏£‡∏µ | Phase 1 |
| 3 | ‡πÑ‡∏°‡πà‡∏°‡∏µ Server-side Purchase Verification | ‡∏ã‡∏∑‡πâ‡∏≠‡∏õ‡∏•‡∏≠‡∏°‡πÑ‡∏î‡πâ ‚Üí Energy ‡∏ü‡∏£‡∏µ | Phase 2 |
| 4 | Storage ‡πÑ‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏´‡∏±‡∏™ + HMAC ‡πÉ‡∏ô APK | Decompile APK ‚Üí ‡∏´‡∏≤ secret | Phase 3 |

### ‡∏´‡∏•‡∏±‡∏á‡πÅ‡∏Å‡πâ‡πÄ‡∏™‡∏£‡πá‡∏à:

```
‚úÖ Balance ‡∏≠‡∏¢‡∏π‡πà‡∏ö‡∏ô Server (Firestore) = Source of Truth
‚úÖ Client ‡πÅ‡∏Å‡πâ balance ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ
‚úÖ Purchase verify ‡∏Å‡∏±‡∏ö Google Play API ‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏û‡∏¥‡πà‡∏° Energy
‚úÖ Duplicate purchase ‡∏ñ‡∏π‡∏Å‡∏ö‡∏•‡πá‡∏≠‡∏Å
‚úÖ Local storage ‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏´‡∏±‡∏™
‚úÖ Security ‡∏£‡∏∞‡∏î‡∏±‡∏ö Production-ready
```

---

## ‚è±Ô∏è Timeline

| Phase | Priority | ‡πÄ‡∏ß‡∏•‡∏≤ | ‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ |
|-------|----------|------|----------|
| **Phase 1** | üî¥ CRITICAL | 1-2 ‡∏ß‡∏±‡∏ô | Server-side Balance |
| **Phase 2** | üî¥ CRITICAL | 1-2 ‡∏ß‡∏±‡∏ô | Purchase Verification |
| **Phase 3** | üü° HIGH | 0.5-1 ‡∏ß‡∏±‡∏ô | Token Cleanup & Encryption |
| **Phase 4** | üü¢ OPTIONAL | 0.5 ‡∏ß‡∏±‡∏ô | Firebase App Check |

**‡∏£‡∏ß‡∏°:** 3-5 ‡∏ß‡∏±‡∏ô (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Phase 1-3 ‡∏ó‡∏µ‡πà‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç)

---

## ‚úÖ ‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà Senior Setup ‡πÉ‡∏´‡πâ‡πÅ‡∏•‡πâ‡∏ß

```
‚úÖ Firebase Project: miro-d6856
‚úÖ Google Cloud Service Account: play-store-manager@miro-d6856.iam.gserviceaccount.com
‚úÖ Google Play Developer API: Enabled
‚úÖ Service Account Permissions: Set in Play Console
‚úÖ Firebase Secret: GOOGLE_SERVICE_ACCOUNT_JSON (set)
‚úÖ JSON Key: Secured in Dropbox
```

**Junior ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≥‡∏≠‡∏∞‡πÑ‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏° ‚Üí ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô code ‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢!**

---

## üìã Quick Checklist

### ‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏° (5 ‡∏ô‡∏≤‡∏ó‡∏µ)
- [ ] Git clone repository
- [ ] Firebase CLI installed: `npm install -g firebase-tools`
- [ ] Firebase login: `firebase login`
- [ ] ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Secret: `firebase functions:secrets:access GOOGLE_SERVICE_ACCOUNT_JSON`

### Phase 1 (1-2 ‡∏ß‡∏±‡∏ô)
- [ ] ‡∏≠‡πà‡∏≤‡∏ô `01_PHASE1_FIRESTORE.md`
- [ ] Setup Firestore + ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô Backend
- [ ] ‡πÅ‡∏Å‡πâ Client (EnergyService)
- [ ] Deploy + Test
- [ ] ‚úÖ Client ‡πÑ‡∏°‡πà‡πÅ‡∏Å‡πâ balance ‡πÑ‡∏î‡πâ

### Phase 2 (1-2 ‡∏ß‡∏±‡∏ô)
- [ ] ‡∏≠‡πà‡∏≤‡∏ô `02_PHASE2_PURCHASE.md` (**‡∏Ç‡πâ‡∏≤‡∏° Step 2.1!**)
- [ ] ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô verifyPurchase function
- [ ] ‡πÅ‡∏Å‡πâ PurchaseService
- [ ] Deploy + Test
- [ ] ‚úÖ Purchase verify ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô

### Phase 3 (0.5-1 ‡∏ß‡∏±‡∏ô)
- [ ] ‡∏≠‡πà‡∏≤‡∏ô `03_PHASE3_ENCRYPTION.md`
- [ ] Token cleanup + SecureStorage
- [ ] Test
- [ ] ‚úÖ Code cleanup ‡πÄ‡∏™‡∏£‡πá‡∏à

---

## üéì ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Junior Developer

### ‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô:

1. **‡∏≠‡πà‡∏≤‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô**
   - ‡∏≠‡πà‡∏≤‡∏ô‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡πÅ‡∏ï‡πà‡∏•‡∏∞ Phase ‡πÉ‡∏´‡πâ‡∏à‡∏ö‡∏Å‡πà‡∏≠‡∏ô
   - ‡∏î‡∏π‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á code ‡πÉ‡∏´‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à
   - ‡∏≠‡πà‡∏≤‡∏ô Expected Result

2. **‡∏ó‡∏≥‡∏ó‡∏µ‡∏•‡∏∞ Step**
   - ‡∏≠‡∏¢‡πà‡∏≤‡∏£‡∏µ‡∏ö
   - ‡∏ó‡∏≥‡∏Ñ‡∏£‡∏ö‡∏ó‡∏∏‡∏Å step
   - Test ‡πÅ‡∏ï‡πà‡∏•‡∏∞ step ‡∏Å‡πà‡∏≠‡∏ô‡πÑ‡∏õ‡∏ï‡πà‡∏≠

3. **Test ‡∏ö‡πà‡∏≠‡∏¢‡πÜ**
   - ‡πÉ‡∏ä‡πâ `99_TESTING_CHECKLIST.md`
   - ‡πÄ‡∏ä‡πá‡∏Ñ Firebase Console real-time
   - ‡πÄ‡∏Å‡πá‡∏ö screenshot ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå

4. **Commit ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏ï‡πà‡∏•‡∏∞ Phase**
   ```bash
   git add .
   git commit -m "feat: Phase 1 - Firestore Balance complete"
   git push
   ```

### ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÑ‡∏´‡∏£‡πà‡∏Ñ‡∏ß‡∏£‡∏ñ‡∏≤‡∏°:

‚úÖ **‡∏ñ‡∏≤‡∏°‡πÑ‡∏î‡πâ:**
- ‡πÑ‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô (‡∏´‡∏•‡∏±‡∏á‡∏≠‡πà‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß)
- Error ‡∏ó‡∏µ‡πà‡πÅ‡∏Å‡πâ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ (‡∏•‡∏≠‡∏á‡πÅ‡∏•‡πâ‡∏ß 15-30 ‡∏ô‡∏≤‡∏ó‡∏µ)
- ‡πÑ‡∏°‡πà‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏ß‡πà‡∏≤‡∏ó‡∏≥‡∏ñ‡∏π‡∏Å‡πÑ‡∏´‡∏°

üü° **‡∏•‡∏≠‡∏á‡πÅ‡∏Å‡πâ‡∏Å‡πà‡∏≠‡∏ô:**
- Syntax errors
- Import errors
- Compilation errors

‚ùå **‡∏≠‡∏¢‡πà‡∏≤‡∏ñ‡∏≤‡∏°:**
- ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏≠‡πà‡∏≤‡∏ô‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£
- ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏•‡∏≠‡∏á‡∏ó‡∏≥

---

## üìä Expected Outcome

### ‡∏´‡∏•‡∏±‡∏á‡πÄ‡∏™‡∏£‡πá‡∏à Phase 1-2 (3-4 ‡∏ß‡∏±‡∏ô):

**Security Status:**
```
Before:
‚ùå Client ‡πÅ‡∏Å‡πâ balance ‡πÑ‡∏î‡πâ (CRITICAL)
‚ùå Token forgery ‡∏ó‡∏≥‡πÑ‡∏î‡πâ (CRITICAL)
‚ùå Purchase ‡∏õ‡∏•‡∏≠‡∏°‡πÑ‡∏î‡πâ (CRITICAL)
‚ùå Duplicate purchase ‡πÑ‡∏î‡πâ (CRITICAL)

After:
‚úÖ Client ‡πÅ‡∏Å‡πâ balance ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ
‚úÖ Token forgery ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ú‡∏•
‚úÖ Purchase verify ‡∏Å‡∏±‡∏ö Google Play
‚úÖ Duplicate purchase ‡∏ñ‡∏π‡∏Å‡∏ö‡∏•‡πá‡∏≠‡∏Å
```

**Firestore Structure:**
```
/energy_balances/{deviceId}
  balance: number
  lastUpdated: timestamp
  welcomeGiftClaimed: boolean

/purchase_records/{purchaseToken_hash}
  deviceId: string
  productId: string
  energyAmount: number
  verifiedAt: timestamp
  orderId: string
  status: "verified"
```

---

## üîí Security Notes

### ‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏£‡∏∞‡∏ß‡∏±‡∏á:

1. **JSON Key File**
   - ‚ùå ‡∏≠‡∏¢‡πà‡∏≤ commit ‡πÄ‡∏Ç‡πâ‡∏≤ Git
   - ‚ùå ‡∏≠‡∏¢‡πà‡∏≤‡πÅ‡∏ä‡∏£‡πå‡πÉ‡∏ô chat/email
   - ‚úÖ ‡πÄ‡∏Å‡πá‡∏ö‡πÑ‡∏ß‡πâ‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢

2. **Firebase Secret**
   - ‚úÖ ‡πÉ‡∏ä‡πâ `firebase functions:secrets:set`
   - ‚ùå ‡∏≠‡∏¢‡πà‡∏≤ hardcode ‡πÉ‡∏ô code

3. **.gitignore**
   ```
   *.json
   miro-d6856-*.json
   .env
   ```

---

## üìû Support

### ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏°‡∏µ Troubleshooting Section

‡πÅ‡∏ï‡πà‡∏•‡∏∞ Phase ‡∏°‡∏µ section **Troubleshooting** ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ:
- Common errors
- How to fix
- What to check

### ‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡∏ï‡∏¥‡∏î:

1. ‡∏≠‡πà‡∏≤‡∏ô Troubleshooting section
2. ‡∏•‡∏≠‡∏á Google error message
3. ‡πÄ‡∏ä‡πá‡∏Ñ Firebase Console logs
4. ‡∏ñ‡∏≤‡∏° Senior ‡∏û‡∏£‡πâ‡∏≠‡∏°:
   - Error message ‡πÄ‡∏ï‡πá‡∏°‡πÜ
   - Steps to reproduce
   - ‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏•‡∏≠‡∏á‡πÅ‡∏Å‡πâ‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß

---

## üéâ Let's Start!

**‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡πÅ‡∏£‡∏Å:**

```bash
# 1. ‡∏≠‡πà‡∏≤‡∏ô‡πÑ‡∏ü‡∏•‡πå‡∏ô‡∏µ‡πâ
üìñ 00_QUICK_START.md

# 2. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö setup
firebase functions:secrets:access GOOGLE_SERVICE_ACCOUNT_JSON

# 3. ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏≥ Phase 1
üìñ 01_PHASE1_FIRESTORE.md
```

---

## üìö All Documents

```
1. 00_QUICK_START.md          - Setup info + Quick checklist
2. 00_OVERVIEW.md             - Project overview + Architecture
3. 01_PHASE1_FIRESTORE.md     - Firestore Balance (CRITICAL)
4. 02_PHASE2_PURCHASE.md      - Purchase Verification (CRITICAL)
5. 03_PHASE3_ENCRYPTION.md    - Token & Encryption (HIGH)
6. 04_PHASE4_APPCHECK.md      - Firebase App Check (OPTIONAL)
7. 99_TESTING_CHECKLIST.md    - Testing checklist for all phases
```

---

## üí™ You Got This!

‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ô‡∏µ‡πâ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏°‡∏≤‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ñ‡∏≤‡∏°

- ‚úÖ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏£‡∏ö 100%
- ‚úÖ ‡∏°‡∏µ code examples ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
- ‚úÖ ‡∏°‡∏µ test cases
- ‚úÖ ‡∏°‡∏µ troubleshooting
- ‚úÖ ‡∏°‡∏µ timeline
- ‚úÖ ‡∏°‡∏µ checklist

**Just follow the steps ‡πÅ‡∏•‡∏∞‡∏Ñ‡∏∏‡∏ì‡∏à‡∏∞‡∏ó‡∏≥‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! üöÄ**

---

*README*  
*Version: 1.0*  
*Last Updated: 15 Feb 2026*  
*Project: MIRO Energy Security Upgrade*  
*For: Junior Developer*
